<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0123) -->
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Python Decorators Don't Have to be (that) Scary - Siafoo</title>

<meta content="tips, tricks, functions, decorators" name="keywords">
<style>
.clear{float:none!important;clear:both!important}.hidden{display:none!important}.javascript_only{display:none}.left{float:left}.right{float:right}body{margin:0;background-color:#FFFFF8}a{text-decoration:none}a:hover{text-decoration:underline}a img{border:0}a.image:hover{background-color:#e8f0f5}form{margin-bottom:0}h1{margin:0.5em 0 0.5em 0;font-size:150%;text-align:center}h2{margin:0.8em 0 0.6em 0;font-size:130%;text-align:center}h3{margin:1em 0 0.8em 0;font-size:115%;text-align:center}h3.left{text-align:left}h6{margin:0.7em 0 0 0;font-size:medium;font-weight:bold}h6.minor{font-weight:normal}table{border-collapse:collapse}body.admin_mode{border:5px solid red}div#main{margin:2em}div#footer{clear:both;border-top:1px solid #a8a8a8;padding:0.75em;font-size:small;line-height:1em}div#footer a{margin-right:1em;color:gray}div#footer div.right{color:gray}div#header{position:relative;overflow:hidden;background-color:#3b6a85;font-family:'Verdana', sans-serif;color:white;zoom:1}div#header ul{margin:0;padding:0;list-style:none}div#header li{display:inline}div#header a{color:white}div#header a:hover{text-decoration:none;color:#f60}div#header .active span.corner_ul{position:absolute;top:0;left:0;height:5px;width:5px;background:url('/img/corner_5px_ul_r6.gif') no-repeat top left}div#header .active span.corner_ur{position:absolute;top:0;right:0;height:5px;width:5px;background:url('/img/corner_5px_ur_r6.gif') no-repeat top right}div#header .active span.corner_ll{position:absolute;bottom:0;left:0;height:5px;width:5px;background:url('/img/corner_5px_ll_r6.gif') no-repeat bottom left}a#header_logo{position:absolute;top:0;left:0}div#header_logo_hack{height:50px;width:184px;padding-right:4px}div#header_login_block{position:absolute;top:0;right:0}div#header_login_hack{float:right;visibility:hidden}div#header span.header_links{margin-right:3em;vertical-align:top;font-size:70%;font-weight:bold}div#header span.header_links a{margin-left:0.5em}div#header span.header_links a.active{color:#f60}div#header span.header_login{vertical-align:top;font-size:90%;font-weight:bold}a#header_options{position:relative;padding-left:1px;padding-right:1px}a#header_options span.text{z-index:1;position:relative}a#header_options.active{padding-bottom:5em;line-height:100%;background-color:#e8f0f5;color:#ff6600}div#header table#header_misc{margin-left:0.2em;white-space:nowrap;border-bottom:1px solid #3b6a85}div#header table#header_misc tr{vertical-align:middle}div#header table#header_misc td{padding-bottom:1px}div#header td#header_home{font-size:90%;font-weight:bold}div#header td#header_home a.active{color:#f60;margin-bottom:2px}div#header td.header_notes{width:1px;font-size:70%}div#header td.header_notes a{float:right;margin:2px 5px;white-space:nowrap;color:#fd5}div#header td.header_notes a:hover{color:#f60}div#header td#header_messages a{position:relative;margin:0;padding:2px 9px 2px 5px}div#header td#header_messages.active a{background-color:#e8f0f5;color:#ff6600}div#header td.header_notes_stale a{filter:alpha(opacity=50);opacity:.5}div#header td.header_notes a:hover, div#header td#header_messages.active a{filter:alpha(opacity=100);opacity:1}div#header table{overflow:hidden;width:100%}div#header tr, div#header td{vertical-align:bottom}div#header td{margin:0;padding:0}div#header td#header_menu_block{width:100%}ul#header_menu_titles{position:relative;z-index:2;float:left;text-align:center}ul#header_menu_titles a{position:relative;float:left;width:5em;margin-top:0.2em;margin-bottom:-999px;padding-bottom:999px;font-size:140%;font-weight:bold;color:#f60}ul#header_menu_titles a:hover{}ul#header_menu_titles li.active a{background-color:#e8f0f5}div#header_menus div.menu{position:relative;z-index:2;float:left;clear:both;margin-top:0.4em;margin-right:0.2em;margin-bottom:-1px;padding:0 0.25em 0px 0.25em;background-color:#e8f0f5}div#header_menus div.menu.right{float:right}div#header_menus div.menu{display:none}div#header_menus div.menu.active{display:block}div#header_menus a{float:left;padding:0.2em 0.5em 0.2em 0.5em;font-size:110%;font-weight:bold;color:#3b6a85}div#header_menus li.new_list a{margin-left:0.5em;padding-left:1em;background:url('/icons/v_bar_16_r6.png') no-repeat center left}div#header_menus li.active a{color:#f60}div#header_menus span.mailbox_count{font-weight:normal;font-size:90%}div.bread_crumbs{margin-top:1px;font-style:'Verdana',sans-serif;color:#3b6a85}div.bread_crumbs a{color:#3b6a85}div.bread_crumbs a:hover{text-decoration:none;color:#f60}div.bread_crumbs img{margin-left:0.35em;height:1em;vertical-align:-12%}div.bread_crumbs span.arrow{font-size:130%;font-weight:bold}textarea.line{height:1em;width:100%}textarea.code{height:5em;width:100%}div.filters{clear:both;line-height:1.2em}table.filters col.filter_list{width:100%}table.filters img{vertical-align:middle}table.filters td.title{padding-left:0;white-space:nowrap}table.filters tr.filter_group div.filter_list_box{height:1.2em;width:100%;position:relative;overflow:hidden}table.filters tr.filter_group div.filter_list{left:0;position:absolute;white-space:nowrap}form.primitive_edit textarea{width:100%;font-family:monospace}form .field_error{color:red}input, select, textarea{margin:0;border:1px solid #CFCFCC;background:#FFFCFC}input.checkbox{height:1em;width:1em;vertical-align:top}form.primitive_edit input.required,form.primitive_edit select.required,form.primitive_edit textarea.required{border:2px solid black}input.has_error,select.has_error,textarea.has_error,form.primitive_edit input.has_error,form.primitive_edit select.has_error,form.primitive_edit textarea.has_error{border:2px solid red}form span.checkbox_inline{margin-left:0.2em}html.full_screen, body.full_screen{overflow:hidden}form div.full_screen{visibility:visible;z-index:10;background-color:white}form div.full_screen textarea, form.primitive_edit div.full_screen textarea{position:absolute;top:0;left:0;height:100%;width:100%;border:0}a.enable_full_screen{float:right;margin-right:1.5em}a.disable_full_screen{visibility:visible;position:absolute;z-index:11;top:0;right:0;margin-right:1em;background-color:white}a.enable_full_screen img, a.disable_full_screen img{vertical-align:bottom}div.list_item{margin-bottom:1em;margin-top:1em}div.list_item a.title{font-weight:bold}div.list_item span.info{margin-right:15px;white-space:nowrap}table.threads{clear:both;width:100%}table.threads col.thread_preview{width:100%}table.threads img.attachment,table.threads img.unread{vertical-align:middle}tbody.thread_unread tr.thread_header,tr.message_unread div.header{font-weight:bold}tbody.thread{clear:both;border:1px solid black}tbody.thread tr.thread_header{border:1px solid black;background-color:#FC0;white-space:nowrap}tbody.thread tr.thread_header div.thread_preview{margin-left:1em;margin-right:1em;height:1em;overflow:hidden;white-space:normal}tbody.thread tr.thread_header div.thread_preview a{color:gray}tr.message td, tr.thread_actions td, tr.thread_reply td{padding:0}tr.message{clear:both;border:1px solid black}tr.message img.profile{float:right;margin-top:0.2em;margin-bottom:0.2em}tr.message div.header{height:1em;padding:0.2em 0.5em;background-color:#FFE680}tr.message div.header span.message_preview{margin-left:1em;line-height:1.2em}tr.message div.header span.message_preview a{color:gray}tr.message div.body{padding:0.8em 0.5em}tr.message div.attachments{padding:0.2em 0.5em;background-color:#D7E3F4}tr.message div.actions{float:right;padding:0.4em 0.5em;font-size:smaller;white-space:nowrap}tr.message a.action{margin-left:1em}tbody.thread tr.thread_actions{border:1px solid black}tbody.thread div.thread_actions{padding:0.2em 0.5em;background-color:#2C5AA0;font-size:smaller}tbody.thread div.thread_actions a{margin-right:1em;white-space:nowrap;color:#FC0}table.threads form.reply{padding:0.2em 0.5em;background-color:#2C5AA0;color:#FFCC00;font-size:smaller}table.threads form.reply textarea{height:100%;width:100%;margin-top:0.2em;margin-bottom:0.2em}table.threads form.reply button{margin:0;border:0;padding:0;background:inherit;color:inherit;font-size:inherit;font-family:inherit;cursor:pointer}tbody.thread form.thread_reply button:hover{text-decoration:underline}tbody.thread form.reply, tr.message form.reply{display:none}tbody.thread_reply form.reply, tr.message_reply form.reply{display:block}tbody.thread_reply div.thread_actions{display:none}tr.message_unread a.mark_new{display:none}tbody.thread_closed tr.message,tbody.thread_closed tr.thread_actions,tbody.thread_closed tr.thread_reply{display:none}tr.message_closed img.profile,tr.message_closed div.actions,tr.message_closed div.body,tr.message_closed div.attachments{display:none}tbody.thread tr.thread_header div.thread_preview{visibility:hidden}tbody.thread_closed tr.thread_header div.thread_preview{visibility:visible}tr.message div.header span.message_preview{display:none}tr.message_closed div.header span.message_preview{display:inline}tr.message_closed div.header{overflow:hidden}div.nodule_column{float:left;width:50%}div.nodule{float:left;clear:both;margin:0.5em 0em 0.5em 0em;border-width:1px;border-style:solid;border-color:#FFF #EEE #EEE #FFF;padding:0.5em;background-color:#F5FAFF}div.nodule_group{float:left;clear:both}div.nodule_group div.nodule{clear:none}div.nodule_column_left div.nodule{margin-right:0.5em}div.nodule_column_right div.nodule{margin-left:0.5em}div.nodule h4{margin:-0.5em -0.5em 0.5em -0.5em;padding:0.2em 0.5em 0.2em 0.5em;background-color:#FF9}div.nodule h4 div{float:right}div.nodule ul{margin:0.5em 0 0.5em 0;padding:0 0 0 1em}div.nodule ul.user_navigation{margin:0;padding:0;list-style:none}div.nodule form{margin:0;border:none;padding:0;background:none}div.nodule form.options{margin:-0.5em -0.5em 0.5em -0.5em;padding:0.2em 0.5em 0.2em 0.5em;font-size:80%}div.nodule form.options input{margin-left:0.5em;vertical-align:bottom}div.nodule div.loading{float:right;height:16px;width:16px;background:url('/img/loading_inline_r6.gif') no-repeat center center}div.nodule div.tree{margin-top:0.5em}div.rating{float:right;clear:right;position:relative;height:8.5em;width:13.5em;margin:0.5em auto}div.rating_text{position:absolute;height:6em;width:4em;top:0.65em;text-align:center}div.rating_text div.average div#rating_average{font-size:150%;line-height:85%}div.rating_text div.count{margin-top:0.8em}div.rating_text div.count div#rating_count{font-size:120%;line-height:75%}div.rating_widget{position:absolute;height:6em;width:9.5em;top:0.65em;left:4em}div.rating_widget div.thermometer{position:absolute;height:100%;width:1.5em;border:1px solid black}div.rating_widget div.thermometer div.fill{position:absolute;bottom:0;width:100%;background-color:red}div.rating_widget div.steps{position:absolute;height:100%;width:6.5em;left:1.5em}div.rating_widget div.step{position:absolute}div.rating_widget div.tick{position:absolute;width:0.3em;left:0.1em;border-top:1px solid black}div.rating_widget div.number{position:absolute;top:-0.5em;left:0.7em;line-height:1em}div.rating_widget div.knob{position:absolute;top:120%;left:0}div.rating_widget div.knob img.knob{position:absolute;height:1.3em;top:-0.65em;left:0.75em}div.rating_widget div.knob div.label{position:absolute;top:-0.5em;left:3.5em;line-height:1em;white-space:nowrap}div.rating_widget div.knob div.label span{font-size:90%}div.rating_widget div.status_top{position:absolute;top:0;left:4em;font-size:80%;color:gray}div.rating_widget div.status_bottom{position:absolute;bottom:0;left:4em;font-size:80%;color:gray}span.rating_thermometer_horizontal{position:relative;top:-0.1em;padding-right:4em;background-color:#EEE}span.rating_thermometer_horizontal span.fill{z-index:1;position:absolute;top:0;left:0;height:100%;background-color:#FFB5BB}span.rating_thermometer_horizontal span.text{z-index:1;position:absolute;top:0.1em;left:0;height:100%;width:100%;text-align:center}div.tour_navigation{position:relative}div.tour_navigation a.previous{position:absolute;top:0;left:0}div.tour_navigation a.next{position:absolute;top:0;right:0}div.tour_navigation div.label{text-align:center}div.tree_branch a.toggle{padding-left:16px;padding-top:2px;background-image:url('/icons/arrow_left_r6.png');background-position:top center;background-repeat:no-repeat}div.tree_branch_open a.toggle{background-position:bottom center;background-image:url('/icons/arrow_down_r6.png')}div.tree_branch_no_children a.toggle{display:none}div.tree_branch a.toggle:hover{text-decoration:none}div.tree_branch div.tree_children{display:none;margin-left:2em}div.tree_branch_open div.tree_children{display:block}form .form_annotation{margin-left:1em}form .form_error{margin-bottom:5px;color:red}form.collapsed{float:left;_width:1%}.form_help{text-align:center}.item_control a, .item_info div, .item_stats{display:inline;white-space:nowrap;margin-right:15px}.filter, .keyword{white-space:nowrap;margin-right:8px}div.mailbox_pager{margin-bottom:2em;text-align:center}div.mailbox_pager a{margin-left:1em;margin-right:1em}div.mailbox_actions{margin-top:2em;text-align:center}div.mailbox_message{text-align:center}span.confirm{text-align:center;margin-left:1em;font-family:sans-serif;font-size:90%}span.confirm a{margin-left:0.5em}#global_msg h3{padding:2px;margin:0;margin-bottom:10px;background-color:yellow;text-align:center;margin:0 1.0em 0 1.0em}a img{vertical-align:middle}.compact_item{margin-bottom:1em;margin-top:1em}.item_title{font-weight:bold}.item_description p, .library_description p, .compact_item p{margin-top:0.2em;margin-bottom:0px}.item_title_and_description img{vertical-align:text-bottom}.item_stats{clear:both}.item_stats span{padding-right:1em}.page_nums{width:100%;text-align:center;border-top:1px solid #E4E4E4;border-bottom:1px solid #E4E4E4}.page_nums a{padding-right:5px}.comment{clear:both;background:#FFFCFC;padding-top:1.0em;width:50em}.add_comment{margin-top:1.0em}.add_comment label{background-color:#ECCB0E;clear:right;display:inline;padding:0.1em 0.5em 0.1em 0.5em;font-weight:bold}.comment_form{background:#ECCB0E;color:#1526AB;display:block;padding:0.5em 0.5em 0.5em 0.5em;margin-bottom:2em}.comment_form textarea{display:block;margin-bottom:0.5em;width:32em;height:8em}.comment_header, .comment_header_own{background:#FFDCDC;color:#1526AB;display:inline;font-weight:bold;padding:0em 0.5em 0em 0.5em}.comment_header_own{background:#FFDC0F}.comment_message{background:#FFFCFC}.indent{margin-left:15px}form.boxed{clear:both;margin:0;border:1px solid #d6d6d6;border-left-color:#e4e4e4;border-top-color:#e4e4e4;padding:0.5em;background-color:#fafafa}form.boxed td{font-size:1.0em}form.boxed .field_unit{margin-bottom:0.5em}form.boxed div.field_content{margin-left:1.5em;margin-right:1.5em}form.boxed .field_info{font-size:0.9em}fieldset{margin:0.5em 1em 0.5em 0;border:1px solid #CFCFCC;padding:0.5em}form.primitive_edit fieldset{float:left;clear:both}fieldset legend{cursor:pointer}.form_buttons{border-top:1px solid #CFCFCC;margin-top:0.5em;padding-top:0.5em;width:100%}.form_buttons input{font-weight:bold;font-size:1.1em}.minimize_triangle{margin-right:0.2em;height:0.8em;vertical-align:text-top}.password_reset{margin-right:3.5em;margin-top:0.4em}form.boxed ul{list-style:none}.preview{background-color:#f8f8f8;margin-bottom:2em}#snippet_history table{text-align:center}.element p{margin:0;padding:4px}.warning_container{padding:5px 5px 5px 5px}.reported_warning{font-weight:bold;border:1px solid red;padding:0px 5px 5px 5px}.reported_warning img{vertical-align:middle}.group_members img{vertical-align:text-bottom}.user_info{padding-top:0.3em;margin-bottom:0.2em;border-bottom:2px #6699CC groove;width:30em;color:#473C52}.user_stats_block{float:left;font-weight:bold;width:11em;border-top:2px #6699CC groove}.user_actions{float:left;font-weight:normal;border-left:1px #6699CC solid;padding-left:0.5em;padding-bottom:0.5em}.profile_blob{margin-bottom:1.5em;width:300px}.profile_blob_head{background-color:#FFE034;border:medium none !important;color:#545454;height:20px;margin:0px !important;padding:3px 6px 3px 12px !important;width:300px;font-family:Verdana,Helvetica,Arial,sans-serif;font-size:12px;font-style:normal;font-variant:normal;font-weight:bold}.profile_blob_body{margin-left:0.6em}table.recent_activity{text-align:center;font-family:Verdana;font-weight:bold;color:#404040;border:1px #6699CC solid;border-spacing:0px;margin-top:1em}.recent_activity th{text-align:center;font-family:Verdana;font-weight:bold;color:#404040;background-color:#fafafa;border:1px #6699CC solid;border-spacing:0px;margin:1em;padding:0 0.9em 0 1.0em}.recent_activity td{text-align:center;font-family:Verdana;font-weight:normal;border-left:1px #6699CC solid;border-spacing:0px;margin:1em;padding:0 0.9em 0 1.0em}td.td_disable{text-align:center;font-family:Verdana;font-weight:bold;color:#404040;background-color:#A9A9A9;border:1px #6699CC solid;border-spacing:0px;margin:1em;padding:0 0.9em 0 1.0em}.help_search{margin-bottom:1.0em}.help_page_title_and_description{margin-top:1em;margin-bottom:1em}.create_help{margin-bottom:1em}.create_help a.create_head{font-size:larger;font-weight:bold;margin-right:0.2em}.create_help span{padding-left:0.2em;margin-left:0.2em;text-indent:0.2em}.create_help p{margin-left:3.0em;margin-top:-1.0em;text-indent:6.0em}.tab_button, .tab_selected, span.tab_button:hover{width:4em;border:1px solid #d6d6d6;border-left-color:#e4e4e4;border-top-color:#e4e4e4;text-align:center;padding-left:1.0em;padding-right:1.0em;cursor:pointer}a.tab_button, a.tab_selected:hover{text-decoration:none}a.tab_button:hover{background:gray;color:black}.tab_selected{background:black;color:white}.tab_button{color:black}.tab_buttons{margin-bottom:0.9em;border-bottom:1px groove #CFCFCC;width:35em}.tab_content{margin-left:1.5em}#account{padding-left:1.5em;border-left:1px groove #CFCFCC}.ver_warning{clear:both;margin:0.7em 0 0.7em 0}.ver_warning span{padding:0.5em 0.5em 0.5em 0.5em;border:1px groove #CFCFCC;background:yellow;font-weight:bold;color:black}.filter_box{clear:both;margin-left:-0.5em;margin-right:-0.5em;margin-top:1.0em;margin-bottom:0.5em;border:1px solid #d6d6d6;border-left-color:#e4e4e4;border-top-color:#e4e4e4;padding:0.5em;background-color:#FAFAFA}.filter_box h3, .browse_blip h3{margin-top:0;text-align:left}.browse_blip h3{margin-top:1.5em}.inline_img{vertical-align:-5%}table#notifications th, table#notifications td{padding:0.5em;text-align:center}table#notifications{margin-bottom:0.5em}table#contacts th, table#contacts td{padding:0.5em}table#contacts{margin-bottom:2em}.article .document{clear:both;margin-top:10px;margin-bottom:10px;border-top:2px solid silver;border-bottom:2px solid silver;padding-top:10px;padding-bottom:10px}#addcontact legend{font-size:120%;font-weight:bold}.license_img{float:right}.admin_image{float:left;padding:1em 1em 0em 0em}.highlight{overflow:auto;background:#FCFEFF;border:1px #FFF7F0 solid;border-bottom:1px #C1C4C5 solid;border-right:1px #C1C4C5 solid;margin:5px 0 5px -1px;padding:0 0.5em 0 0.5em}.highlight pre{margin-top:0;margin-bottom:1px}.lineno{background:#FFFDA2;color:#000000;font-weight:bold;padding:0px 5px 0px 3px;border-top:1px #FFFEF8 solid;border-bottom:1px #A1A4A5 solid;border-left:1px #FFFEF8 solid;border-right:1px #C1C4C5 solid;margin:0 0.5em 0 -0.5em}table.diff{font-family:Courier;border:medium}.diff_header{background-color:#e0e0e0}td.diff_header{text-align:right}.diff_next{background-color:#c0c0c0}.diff_add{background-color:#afa}.diff_chg{background-color:#ff7}.diff_sub{background-color:#faa}.highlight .c{color:#080;font-style:italic}.highlight .err{border:1px solid #FF0000}.highlight .k{color:#00F;font-weight:bold}.highlight .o{color:#666}.highlight .cm{color:#080;font-style:italic}.highlight .cp{color:#00F}.highlight .c1{color:#080;font-style:italic}.highlight .cs{color:#080;font-weight:bold}.highlight .gd{color:#A00000}.highlight .ge{font-style:italic}.highlight .gr{color:#F00}.highlight .gh{color:#000080;font-weight:bold}.highlight .gi{color:#00A000}.highlight .go{color:#808080}.highlight .gp{color:#000080;font-weight:bold}.highlight .gs{font-weight:bold}.highlight .gu{color:#800080;font-weight:bold}.highlight .gt{color:#0040D0}.highlight .kc{color:#A2F;font-weight:bold}.highlight .kd{color:#A2F;font-weight:bold}.highlight .kp{color:#A2F}.highlight .kr{color:#A2F;font-weight:bold}.highlight .kt{color:#A2F;font-weight:bold}.highlight .m{color:#666}.highlight .s{color:#B44}.highlight .na{color:#F00}.highlight .nb{color:#A2F}.highlight .nc{color:#00F}.highlight .no{color:#800}.highlight .nd{color:#A2F}.highlight .ni{color:#999;font-weight:bold}.highlight .ne{color:#D2413A;font-weight:bold}.highlight .nf{color:#000}.highlight .nl{color:#A0A000}.highlight .nn{color:#000;font-weight:bold}.highlight .nt{color:#008000;font-weight:bold}.highlight .nv{color:#B8860B}.highlight .ow{color:#A2F;font-weight:bold}.highlight .mf{color:#666}.highlight .mh{color:#666}.highlight .mi{color:#666}.highlight .mo{color:#666}.highlight .sb{color:#B44}.highlight .sc{color:#B44}.highlight .sd{color:#B44;font-style:italic}.highlight .s2{color:#B44}.highlight .se{color:#B62;font-weight:bold}.highlight .sh{color:#B44}.highlight .si{color:#B68;font-weight:bold}.highlight .sx{color:#008000}.highlight .sr{color:#B68}.highlight .s1{color:#B44}.highlight .ss{color:#B8860B}.highlight .bp{color:#A2F}.highlight .vc{color:#B8860B}.highlight .vg{color:#B8860B}.highlight .vi{color:#B8860B}.highlight .il{color:#666}div.rest h1, div.rest h2, div.rest h3, div.rest h4, div.rest h5, div.rest h6{text-align:left;margin-top:1.5em}div.rest h2{}div.rest .borderless, div.rest table.borderless td, div.rest table.borderless th{border:0}div.rest table.borderless td, div.rest table.borderless th{padding:0 0.5em 0 0 ! important}div.rest .first{margin-top:0 ! important}div.rest .last, div.rest .with-subtitle{margin-bottom:0 ! important}div.rest .hidden{display:none}div.rest a.toc-backref{text-decoration:none;color:black}div.rest blockquote.epigraph{margin:2em 5em}div.rest dl.docutils dd{margin-bottom:0.5em}div.rest div.abstract{margin:2em 5em}div.rest div.abstract p.topic-title{font-weight:bold;text-align:center}div.rest div.admonition, div.rest div.attention, div.rest div.caution, div.rest div.danger, div.rest div.article error, div.rest div.hint, div.rest div.important, div.rest div.note, div.rest div.tip, div.rest div.warning{margin:2em;border:1px outset;padding:1em}div.rest div.admonition p.admonition-title, div.rest div.hint p.admonition-title, div.rest div.important p.admonition-title, div.rest div.note p.admonition-title, div.rest div.tip p.admonition-title{font-weight:bold;font-family:sans-serif}div.rest div.attention p.admonition-title, div.rest div.caution p.admonition-title, div.rest div.danger p.admonition-title, div.rest div.article error p.admonition-title, div.rest div.warning p.admonition-title{color:red;font-weight:bold;font-family:sans-serif}div.rest div.dedication{margin:2em 5em;text-align:center;font-style:italic}div.rest div.dedication p.topic-title{font-weight:bold;font-style:normal}div.rest div.figure{margin-left:2em;margin-right:2em}div.rest div.footer, div.rest div.header{clear:both;font-size:smaller}div.rest div.line-block{display:block;margin-top:1em;margin-bottom:1em}div.rest div.line-block div.line-block{margin-top:0;margin-bottom:0;margin-left:1.5em}div.rest div.sidebar{margin-left:1em;border:1px solid;padding:1em;background-color:#ffe;float:right;clear:right}div.rest div.sidebar p.rubric{font-family:sans-serif;font-size:medium}div.rest div.system-messages{margin:5em}div.rest div.system-messages h1{color:red}div.rest div.system-message{border:3px solid red;padding:0 1em 1em 1em}div.rest div.system-message p.system-message-title{color:red;font-weight:bold}div.rest div.topic{margin:0pt 2em}div.rest h1.section-subtitle, div.rest h2.section-subtitle, div.rest h3.section-subtitle, div.rest h4.section-subtitle, div.rest h5.section-subtitle, div.rest h6.section-subtitle{margin-top:0.4em}div.rest h1.title{text-align:center}div.rest h2.subtitle{text-align:center}div.rest hr.docutils{width:75%}div.rest img.align-left{clear:left}div.rest img.align-right{clear:right}div.rest ol.simple, div.rest ul.simple{margin-bottom:1em}div.rest ol.arabic{list-style:decimal}div.rest ol.loweralpha{list-style:lower-alpha}div.rest ol.upperalpha{list-style:upper-alpha}div.rest ol.lowerroman{list-style:lower-roman}div.rest ol.upperroman{list-style:upper-roman}div.rest p.attribution{text-align:right;margin-left:50%}div.rest p.caption{font-style:italic}div.rest p.credits{font-style:italic;font-size:smaller}div.rest p.label{white-space:nowrap}div.rest p.rubric{font-weight:bold;font-size:larger;color:maroon;text-align:center}div.rest p.sidebar-title{font-family:sans-serif;font-weight:bold;font-size:larger}div.rest p.sidebar-subtitle{font-family:sans-serif;font-weight:bold}div.rest p.topic-title{font-weight:bold}div.rest pre.address{margin-bottom:0;margin-top:0;font-family:serif;font-size:100%}div.rest pre.literal-block, div.rest pre.doctest-block{margin-left:2em;margin-right:2em;background-color:#eee}div.rest span.classifier{font-family:sans-serif;font-style:oblique}div.rest span.classifier-delimiter{font-family:sans-serif;font-weight:bold}div.rest span.interpreted{font-family:sans-serif}div.rest span.option{white-space:nowrap}div.rest span.pre{white-space:pre}div.rest span.problematic{color:red}div.rest span.section-subtitle{font-size:80%}div.rest table.citation{border-left:solid 1px gray;margin-left:1px}div.rest table.docinfo{margin:2em 4em}div.rest table.docutils{margin-top:0.5em;margin-bottom:0.5em}div.rest table.footnote{border-left:solid 1px black;margin-left:1px}div.rest table.docutils td, div.rest table.docutils th, div.rest table.docinfo td, div.rest table.docinfo th{padding-left:0.5em;padding-right:0.5em;vertical-align:top}div.rest table.docutils th.field-name, div.rest table.docinfo th.docinfo-name{font-weight:bold;text-align:left;white-space:nowrap;padding-left:0}div.rest h1 tt.docutils, div.rest h2 tt.docutils, div.rest h3 tt.docutils, div.rest h4 tt.docutils, div.rest h5 tt.docutils, div.rest h6 tt.docutils{font-size:100%}div.rest ul.auto-toc{list-style-type:none}div.rest .license_note{font-size:0.7em;font-family:sans-serif}.dialog_overlay{background-color:black}.loading{background-color:black;background-image:url('/img/loading_r1.gif');background-repeat:no-repeat;background-position:center center}.dialog_box{padding:6px;background-color:white}.dialog_confirm_box{border:2px solid #ccc;line-height:1.2em}.dialog_buttons{margin-top:10px;text-align:center}.dialog_buttons button{margin-left:3px;margin-right:3px}div.autocompleter-loading{float:left;clear:right;background:#fff url(images/spinner.gif) no-repeat center;width:20px;height:16px}ul.autocompleter-choices{position:absolute;margin:0;padding:0;list-style:none;border:1px solid #eee;background-color:white;border-right-color:#ddd;border-bottom-color:#ddd;text-align:left;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;z-index:50}ul.autocompleter-choices li{position:relative;padding:0.1em 1.5em 0.1em 1em;cursor:pointer;font-weight:normal;font-size:1em}ul.autocompleter-choices li.autocompleter-selected{background-color:#444;color:#fff}ul.autocompleter-choices span.autocompleter-queried{font-weight:bold}ul.autocompleter-choices li.autocompleter-selected span.autocompleter-queried{color:#9FCFFF}

</style>
<meta content="MSHTML 6.00.2900.3243" name="GENERATOR"></head>
<body class=" " line-hegiht="">
<div id="main">
<div id="content">
<div class="view article">
<h1>쉽게 설명한 파이썬 장식자</h1>
<div class="byline"><span class="author">By <a href="http://www.siafoo.net/user/david">David</a> </span><span class="date">Updated 2 months ago (30 Jul 2008 at 02:37 PM) </span></div>
<div class="byline"><span class="author">한글판 johnsonj 2008.12.17</span></div>

<div class="abstract"><span class="title">요약:</span>
장식자(Decorators)는 함수를 변경한다. 기본부터 시작하여 포장자를 다양한 방법으로 사용하는 법을 익혀보자. 

함수가 해석되거나 호출될 때 코드를 실행하자. 조건적으로 함수를 호출하고 입력과 출력을 변형해 보자. 임의의 인자를 받는 맞춤 포장자를 작성하자. 그리고 필요하면, 장식된 함수가 원래 함수와 시그너쳐(signature)가 똑 같은지 손쉽게 확인해 보자. </div>
<div class="top_modules">
<div class="content rest">
<div class="document">
<div class="sidebar">
<p class="first sidebar-title">목차</p>
<div class="contents last topic" id="contents">
<ul class="auto-toc simple">
  <li><a class="reference internal" id="id3" href="#the-basics">1&nbsp;&nbsp;&nbsp;기본 지식</a>
  <ul class="auto-toc">
    <li><a class="reference internal" id="id4" href="#does-a-decorator-function-have-to-return-a-function">1.1&nbsp;&nbsp;&nbsp;장식자 함수를 함수를 돌려주어야 하는가?</a> </li></ul>
  </li><li><a class="reference internal" id="id5" href="#run-time-transformations">2&nbsp;&nbsp;&nbsp;실행-시간 변형</a>
  <ul class="auto-toc">
    <li><a class="reference internal" id="id6" href="#the-wrapper-function">2.1&nbsp;&nbsp;&nbsp;포장(Wrapper) 함수</a> 
    </li><li><a class="reference internal" id="id7" href="#getting-the-arguments">2.2&nbsp;&nbsp;&nbsp;인자 얻기</a> 
    </li><li><a class="reference internal" id="id8" href="#summing-it-up">2.3&nbsp;&nbsp;&nbsp;요약</a> </li></ul>
  </li><li><a class="reference internal" id="id9" href="#dynamic-decorators">3&nbsp;&nbsp;&nbsp;동적인 장식자</a>
  <ul class="auto-toc">
    <li><a class="reference internal" id="id10" href="#passing-options-to-the-decorator">3.1&nbsp;&nbsp;&nbsp;옵션을 장식자에게 건네기</a> 
    </li><li><a class="reference internal" id="id11" href="#run-time-tranformations">3.2&nbsp;&nbsp;&nbsp;실행-시간 변형</a> </li></ul>
  </li><li><a class="reference internal" id="id12" href="#caveat-function-signatures">4&nbsp;&nbsp;&nbsp;약점:  함수 시그너쳐</a>
  <ul class="auto-toc">
    <li><a class="reference internal" id="id13" href="#a-solution">4.1&nbsp;&nbsp;&nbsp;해결책</a> </li></ul>
  </li><li><a class="reference internal" id="id14" href="#putting-it-all-together">5&nbsp;&nbsp;&nbsp;모두 하나로 함치기</a> 
  </li><li><a class="reference internal" id="id15" href="#conclusion">6&nbsp;&nbsp;&nbsp;맺는 말</a> 

  </li><li><a class="reference internal" id="id16" href="#references">7&nbsp;&nbsp;&nbsp;참조</a> 
  </li></ul></div>
  
  </div>
<p>
장식자라는 언급만 해도 공포에 질린다. 심지어 제법 훈련이 된 파이썬 프로그래머조차도 말이다.</p>
<p>
좋다. 그렇지 않을 수도 있다. 그러나 장식자는 구문이 기이하고 어쩔 수 없이 복잡하게 구현되었다고 본인은 생각한다. 그래서 특히 파이썬의 단순함에 익숙해진 사람들에게 낯설어 보인다.</p>
<div class="section" id="the-basics">

<h2><a class="toc-backref" href="#id3">1&nbsp;&nbsp;&nbsp;기본 지식</a></h2>
<p>
장식자는 함수를 변경한다. 더 구체적으로 장식자는 <strong>함수를 변형하는 함수</strong>이다.</p>
<p>
장식자를 사용할 때, 파이썬은 장식될 함수를 -- 이를 <em>목표 함수</em>라고 부르겠다 -- <em>장식할 함수</em>에 건넨다. 그리고 그 결과로 교체한다. 장식자가 없다면, 다음과 같이 보일 것이다:</p>
<div class="code" id="1"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno"> 1</span><span class="k">def</span> <span class="nf">decorator_function</span><span class="p">(</span><span class="n">target</span><span class="p">):</span><br><span class="lineno"> 2</span>    <span class="c"># 목표 함수로 일을 한다.</span><br><span class="lineno"> 3</span>    <span class="n">target</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="mf">1</span><br><span class="lineno"> 4</span>    <span class="k">return</span> <span class="n">target</span><br><span class="lineno"> 5</span><br><span class="lineno"> 6</span><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span><br><span class="lineno"> 7</span>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><br><span class="lineno"> 8</span><br><span class="lineno"> 9</span><span class="c"># 이것이 장식자가 실제로 하는 일이다.</span><br><span class="lineno">10</span><span class="n">target</span> <span class="o">=</span> <span class="n">decorator_function</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><br></pre></div></div>
<p>
다음 코드는 정확하게 똑같이 작동하지만, 장식자를 사용한다. 마음대로 <em>장식자 함수</em>의 이름을 지을 수 있다는 것을 주목하자. 여기에서는 'decorator_function'이라고 이름지었다:</p>
<div class="code" id="2"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno">1</span><span class="k">def</span> <span class="nf">decorator_function</span><span class="p">(</span><span class="n">target</span><span class="p">):</span><br><span class="lineno">2</span>    <span class="c"># 목표 함수로 일을 한다.</span><br><span class="lineno">3</span>    <span class="n">target</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="mf">1</span><br><span class="lineno">4</span>    <span class="k">return</span> <span class="n">target</span><br><span class="lineno">5</span><br><span class="lineno">6</span><span class="c"># 다음은 장식자이다. 구문이 '@function_name'이다.</span><br><span class="lineno">7</span><span class="nd">@decorator_function</span><br><span class="lineno">8</span><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span><br><span class="lineno">9</span>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><br></pre></div></div>
<p>
보시다시피, <em>장식자 함수</em>의 이름 앞에 <tt class="docutils literal"><span class="pre">@</span></tt>를 둘 필요가 있다. <em>목표 함수</em> 정의가 있는 줄 바로 앞에 말이다. 파이썬은 내부적으로 <em>목표 함수</em>를 변형한다. 장식자를 목표 함수에 적용하여 반환된 값으로 교체한다.</p>

<p>위의 예제 모두 결과가 같다:</p>
<div class="code" id="3"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno">1</span><span class="gp">&gt;&gt;&gt; </span><span class="n">target</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span><br><span class="lineno">2</span><span class="go">3</span><br><span class="lineno">3</span><span class="gp">&gt;&gt;&gt; </span><span class="n">target</span><span class="o">.</span><span class="n">attribute</span><br><span class="lineno">4</span><span class="go">1</span><br></pre></div></div>
<div class="section" id="does-a-decorator-function-have-to-return-a-function">

<h3><a class="toc-backref" href="#id4">1.1&nbsp;&nbsp;&nbsp;장식자 함수는 함수를 돌려주는가?</a></h3>

<p>
아니다. <em>장식자 함수</em>는 절대로 <strong>무엇이든</strong> 돌려줄 수 있으며, 파이썬은 <em>목표 함수</em>를 그 반환 값으로 교체한다. 예를 들어, 다음과 같이 할 수도 있다:</p>
<div class="code" id="4"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno"> 1</span><span class="k">def</span> <span class="nf">decorator_evil</span><span class="p">(</span><span class="n">target</span><span class="p">):</span><br><span class="lineno"> 2</span>    <span class="k">return</span> <span class="bp">False</span><br><span class="lineno"> 3</span><br><span class="lineno"> 4</span><span class="nd">@decorator_evil</span><br><span class="lineno"> 5</span><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span><br><span class="lineno"> 6</span>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><br><span class="lineno"> 7</span><br><span class="lineno"> 8</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><br><span class="lineno"> 9</span><span class="bp">False</span><br><span class="lineno">10</span><br><span class="lineno">11</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span><br><span class="lineno">12</span><span class="ne">TypeError</span><span class="p">:</span> <span class="s">'bool'</span> <span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">callable</span><br></pre></div></div>
<p>
그렇지만 일상적으로 이렇게 하고 싶지는 않을 것이다 -- 기본 디자인 원리는 함수들을 무작위로 일종의 다른 어떤 것으로 변환시키는데 있지 않다고 확신한다. 적어도 일종의 호출가능 객체를 돌려준다는 것은 말이 된다.</p></div></div>
<div class="section" id="run-time-transformations">
<h2><a class="toc-backref" href="#id5">2&nbsp;&nbsp;&nbsp;실행-시간 변형</a></h2>
<p>
여러분이 이렇게 외치는 소리가 들리는 듯하다. "그러나 장식자는 그 보다 더 많은 일을 한다고 생각해요. 실행-시간에 일을 하고 싶거든요. 예를 들어 조건적으로 함수를 호출하고 그 인자와 반환 값을 변형하는 일들을 말이지요."</p>
<p>
장식자가 이런 일을 할 수 있는가? 그렇다. 정말로 위에 언급한 것보다 '더 많은 일을 하는' 것인가? 실제로는 그렇지 않다. 여기에서 너무 깊이 빠지지 않는 것이 중요하다 -- 장식자에 관하여 알아야 할 것은 이미 모두 알고 있다. 이렇게 복잡한 일 중의 하나를 하려면, 그냥 평범한 파이썬을 추가해 조합하면 된다.</p>
<div class="section" id="the-wrapper-function">
<h3><a class="toc-backref" href="#id6">2.1&nbsp;&nbsp;&nbsp;포장 함수</a></h3>
<p>
기억하자. <em>장식 함수</em>는 임의의 함수를 돌려줄 수 있다. 그것을 <em>포장 함수</em>라고 부르겠다. 그 이유는 잠시 후에 밝혀진다. 여기에서 트릭은  <em>포장 함수</em>를 <em>장식 함수</em> 안에 정의해, <em>목표 함수</em>를 포함하여 <em>장식 함수</em>의 변수 영역에 접근하도록 해주는 것이다.</p>
<div class="code" id="5"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno"> 1</span><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">target</span><span class="p">):</span><br><span class="lineno"> 2</span><br><span class="lineno"> 3</span>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">():</span><br><span class="lineno"> 4</span>    <span class="k">print</span> <span class="s">'Calling function "</span><span class="si">%s</span><span class="s">"'</span> <span class="o">%</span> <span class="n">target</span><span class="o">.</span><span class="n">__name__</span><br><span class="lineno"> 5</span>        <span class="k">return</span> <span class="n">target</span><span class="p">()</span><br><span class="lineno"> 6</span><br><span class="lineno"> 7</span>    <span class="c"># 포장 함수가 목표 함수를 교체하기 때문에, 속성을 목표 함수에 할당해 봐야 작동하지 않는다.</span><br><span class="lineno"> 8</span>    <span class="c"># *포장 함수*에 할당할 필요가 있다.</span><br><span class="lineno"> 9</span>    <span class="n">wrapper</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="mf">1</span><br><span class="lineno">10</span>    <span class="k">return</span> <span class="n">wrapper</span><br><span class="lineno">11</span><br><span class="lineno">12</span><span class="nd">@decorator</span><br><span class="lineno">13</span><span class="k">def</span> <span class="nf">target</span><span class="p">():</span><br><span class="lineno">14</span>    <span class="k">print</span> <span class="s">'I am the target function'</span><br><span class="lineno">15</span><br><span class="lineno">16</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="p">()</span><br><span class="lineno">17</span><span class="n">Calling</span> <span class="n">function</span> <span class="s">"target"</span><br><span class="lineno">18</span><span class="n">I</span> <span class="n">am</span> <span class="n">the</span> <span class="n">target</span> <span class="n">function</span><br><span class="lineno">19</span><br><span class="lineno">20</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="o">.</span><span class="n">attribute</span><br><span class="lineno">21</span><span class="mf">1</span><br></pre></div></div>
<p>
보시다시피, <strong>포장 함수</strong>는 <em>목표 함수</em>의 반환 값을 돌려주는 간단한 사례를 포함하여 <em>목표 함수</em>에 무엇이든 할 수 있다. 그러나 <em>목표 함수</em>에 건네진 인자에 무슨 일이 일어나는가?</p></div>
<div class="section" id="getting-the-arguments">
<h3><a class="toc-backref" href="#id7">2.2&nbsp;&nbsp;&nbsp;인자를 얻기</a></h3>
<p>
반환된 <em>포장자 함수</em>는 <em>목표 함수</em>를 교체하기 때문에, <em>포장 함수</em>는 <em>목표 함수</em>에 건네어질 <strong>인자를 받을 것이다</strong>. 장식자가 어떤 <em>목표 함수</em>에도 작동하기를 원한다고 가정하면, <em>포장 함수</em>는 그러면 <a class="reference external" href="http://www.siafoo.net/article/52#arbitrary-numbers-of-arguments">임의의 비-키워드 인자와 임의의 키워드 인자</a>를 받아야 한다. 필요하면 <em>목표 함수</em>에 <a class="reference external" href="http://www.siafoo.net/article/52#passing-a-list-or-dictionary-as-arguments">인자를 건네고</a>, 추가하고, 삭제하거나 또는 인자를 수정한다.</p>


<div class="code" id="6"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno"> 1</span><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">target</span><span class="p">):</span><br><span class="lineno"> 2</span><br><span class="lineno"> 3</span>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span><br><span class="lineno"> 4</span>        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">'debug'</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span> <span class="c"># 여기에서 키워드 인자를 편집한다, 디버그 모드 활성화</span><br><span class="lineno"> 5</span>        tempStr =  <span class="s">'Calling function "</span><span class="si">%s</span><span class="s">" with arguments </span><span class="si">%s</span><span class="s"> and keyword arguments </span><span class="si">%s</span><span class="s">'</span>
<span class="lineno"> 5</span>        <span class="k">print</span> tempStr <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span><br><span class="lineno"> 6</span>        <span class="k">return</span> <span class="n">target</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><br><span class="lineno"> 7</span><br><span class="lineno"> 8</span>    <span class="n">wrapper</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="mf">1</span><br><span class="lineno"> 9</span>    <span class="k">return</span> <span class="n">wrapper</span><br><span class="lineno">10</span><br><span class="lineno">11</span><span class="nd">@decorator</span><br><span class="lineno">12</span><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span><br><span class="lineno">13</span>    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="k">print</span> <span class="s">'[Debug] I am the target function'</span><br><span class="lineno">14</span>    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><br><span class="lineno">15</span><br><span class="lineno">16</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span><br><span class="lineno">17</span><span class="n">Calling</span> <span class="n">function</span> <span class="s">"target"</span> <span class="k">with</span> <span class="n">arguments</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">keyword</span> <span class="n">arguments</span> <span class="p">{</span><span class="s">'debug'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span><br><span class="lineno">18</span><span class="p">[</span><span class="n">Debug</span><span class="p">]</span> <span class="n">I</span> <span class="n">am</span> <span class="n">the</span> <span class="n">target</span> <span class="n">function</span><br><span class="lineno">19</span><span class="mf">3</span><br><span class="lineno">20</span><br><span class="lineno">21</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="o">.</span><span class="n">attribute</span><br><span class="lineno">22</span><span class="mf">1</span><br></pre></div></div>
<div class="note">
<p class="first admonition-title">주의</p>
<p>
장식자를 <strong>클래스 메쏘드</strong>에 적용할 수도 있다. 장식자가 언제나 이런 식으로 사용되고, 그 현재 실체에 접근할 필요가 있다면, <em>포장 함수</em>는 첫 인자가 언제나 <tt class="docutils literal"><span class="pre">self</span></tt>라고 간주할 수 있다:</p>
<div class="last">
<div class="code" id="7"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno">1</span><span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span><br><span class="lineno">2</span>    <span class="c"># 'self'로 일을 한다.</span><br><span class="lineno">3</span>    <span class="k">print</span> <span class="bp">self</span><br><span class="lineno">4</span>    <span class="k">return</span> <span class="n">target</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><br></pre></div></div></div></div></div>
<div class="section" id="summing-it-up">
<h3><a class="toc-backref" href="#id8">2.3&nbsp;&nbsp;&nbsp;요약</a></h3>
<p>
그래서, <em>장식자 함수</em>안에 정의된 임의의 인자를 받는 <em>포장자 함수</em>가 있다. 그 <em>포장 함수</em>는 원할 경우 <em>목표 함수</em>를 호출할 수 있다. 그 결과를 얻고, 그것으로 일을 한 다음, 원하는 것을 무엇이든 돌려줄 수 있다.</p>
<p>
실행되기 전에 긍정적인 확인을 요구하는 특정한 함수 호출이 필요하다고 생각해 보자. 그 함수의 결과를 돌려주기 전에 문자열 처리를 하고 싶다고 해 보자. 내장 함수 <tt class="docutils literal"><span class="pre">raw_input</span></tt>은 메시지를 인쇄한 다음 표준입력으로부터 응답을 기다린다.</p>
<div class="code" id="8"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno"> 1</span><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">target</span><span class="p">):</span>  <span class="c"># 파이썬은 목표 함수를 장식자에 건넨다.</span><br><span class="lineno"> 2</span><br><span class="lineno"> 3</span>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span><br><span class="lineno"> 4</span>        tempStr = <span class="s">'Are you sure you want to call the function "</span><span class="si">%s</span><span class="s">"? '</span><br><span class="lineno"> 5</span>        <span class="n">choice</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span> tempStr <span class="o">%</span> <span class="n">target</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span><br><span class="lineno"> 6</span><br><span class="lineno"> 7</span>        <span class="k">if</span> <span class="n">choice</span> <span class="ow">and</span> <span class="n">choice</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">'y'</span><span class="p">:</span><br><span class="lineno"> 8</span>            <span class="c"># 입력이 'y'로 시작하면, 그 함수를 인자를 가지고 호출한다.</span><br><span class="lineno"> 9</span>            <span class="n">result</span> <span class="o">=</span> <span class="n">target</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><br><span class="lineno">10</span>            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><br><span class="lineno">11</span><br><span class="lineno">12</span>        <span class="k">else</span><span class="p">:</span><br><span class="lineno">13</span>            <span class="k">print</span> <span class="s">'Call to </span><span class="si">%s</span><span class="s"> cancelled'</span> <span class="o">%</span> <span class="n">target</span><span class="o">.</span><span class="n">__name__</span><br><span class="lineno">14</span><br><span class="lineno">15</span>    <span class="k">return</span> <span class="n">wrapper</span><br><span class="lineno">16</span><br><span class="lineno">17</span><span class="nd">@decorator</span><br><span class="lineno">18</span><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span><br><span class="lineno">19</span>    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><br><span class="lineno">20</span><br><span class="lineno">21</span><span class="o">&gt;&gt;&gt;</span> <span class="n">test</span><span class="o">.</span><span class="n">target</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span><br><span class="lineno">22</span><span class="n">Are</span> <span class="n">you</span> <span class="n">sure</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">call</span> <span class="n">the</span> <span class="n">function</span> <span class="s">"target"</span><span class="err">?</span> <span class="n">n</span><br><span class="lineno">23</span><span class="n">Call</span> <span class="n">to</span> <span class="n">target</span> <span class="n">cancelled</span><br><span class="lineno">24</span><br><span class="lineno">25</span><span class="o">&gt;&gt;&gt;</span> <span class="n">test</span><span class="o">.</span><span class="n">target</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span><br><span class="lineno">26</span><span class="n">Are</span> <span class="n">you</span> <span class="n">sure</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">call</span> <span class="n">the</span> <span class="n">function</span> <span class="s">"target"</span><span class="err">?</span> <span class="n">y</span><br><span class="lineno">27</span><span class="s">'3'</span><br></pre></div></div></div></div>
<div class="section" id="dynamic-decorators">
<h2><a class="toc-backref" href="#id9">3&nbsp;&nbsp;&nbsp;동적인 장식자</a></h2>
<p>
종종 임의의 옵션을 <em>장식자 함수</em>에 건네 행위를 재단하고 싶을 경우가 있다. 장식자 구문을 대충 살펴보면 그렇게 할 방법이 없는 듯 보인다. 그냥 그런 장식자 아이디어를 완전히 버릴 수도 있지만, 그럴 필요가 없다.</p>
<p>
해결책은  또다른 함수 안에 <em>장식자 함수</em>를 정의하는 것이다 -- 이를 옵션 함수라고 부르자. <em>목표 함수</em> 정의 바로 앞에서, 즉 보통 (앞에 <tt class="docutils literal"><span class="pre">@</span></tt>를 붙인) <em>장식자 함수</em>를 두던 곳에서 (앞에다 <tt class="docutils literal"><span class="pre">@</span></tt>를 붙여서) 대신 이 <em>옵션 함수</em>를 호출하자. <em>옵션 함수</em>는 그러면 <em>장식자 함수</em>를 돌려주는데, 여기에다 파이썬은 전과 같이 <em>목표 함수</em>를 인자로 건넨다.</p>
<div class="section" id="passing-options-to-the-decorator">
<h3><a class="toc-backref" href="#id10">3.1&nbsp;&nbsp;&nbsp;장식자에 옵션 건네기</a></h3>
<p>
<em>옵션 함수</em>는 얼마든지 인자를 받을 수 있다. <em>장식자 함수</em>가 <em>옵션 함수</em> 안에 정의되어 있기 때문에, 
<em>장식자 함수</em>는 <em>옵션 함수</em>에 건네진 인자에 얼마든지 접근한다.</p>
<div class="code" id="9"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno"> 1</span><span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="n">value</span><span class="p">):</span><br><span class="lineno"> 2</span><br><span class="lineno"> 3</span>    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">target</span><span class="p">):</span><br><span class="lineno"> 4</span>        <span class="c"># 목표 함수로 여기에서 일을 한다.</span><br><span class="lineno"> 5</span>        <span class="n">target</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="n">value</span><br><span class="lineno"> 6</span>        <span class="k">return</span> <span class="n">target</span><br><span class="lineno"> 7</span>    <span class="k">return</span> <span class="n">decorator</span><br><span class="lineno"> 8</span><br><span class="lineno"> 9</span><span class="nd">@options</span><span class="p">(</span><span class="s">'value'</span><span class="p">)</span><br><span class="lineno">10</span><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span><br><span class="lineno">11</span>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><br><span class="lineno">12</span><br><span class="lineno">13</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span><br><span class="lineno">14</span><span class="mf">3</span><br><span class="lineno">15</span><br><span class="lineno">16</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="o">.</span><span class="n">attribute</span><br><span class="lineno">17</span><span class="s">'value'</span><br></pre></div></div>
<p>
보시다시피, 여기에서 장식자 구문 자체는 아무것도 바뀌지 않았다. <em>장식자 함수</em>는 정적 영역이 아니라 동적 영역에 있다.</p></div>
<div class="section" id="run-time-tranformations">

<h3><a class="toc-backref" href="#id11">3.2&nbsp;&nbsp;&nbsp;실행-시간 변형</a></h3>
<p>
앞에서와 같이 <em>장식자 함수</em>에서 <em>포장 함수</em>를 돌려주면 <a class="reference internal" href="#run-time-transformations">실행-시간 변형</a>을 할 수 있다. 그렇지만 좋든 나쁘든 이제 <em>세 가지</em> 수준의 함수가 있다:</p>
<div class="code" id="10"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno"> 1</span><span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="n">debug_level</span><span class="p">):</span><br><span class="lineno"> 2</span><br><span class="lineno"> 3</span>    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">target</span><span class="p">):</span><br><span class="lineno"> 4</span><br><span class="lineno"> 5</span>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span><br><span class="lineno"> 6</span>            <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">'debug_level'</span><span class="p">:</span> <span class="n">debug_level</span><span class="p">})</span><br><span class="lineno"> 7</span>            <span class="c"># 키워드 인자를 편집한다</span> <span class="c">여기에서, 디버그 수준을 옵션에 지정된 값으로 설정한다.</span><br><span class="lineno"> 8</span>            tempStr = <span class="s">'Calling function "</span><span class="si">%s</span><span class="s">" with arguments </span><span class="si">%s</span><span class="s"> and keyword arguments </span><span class="si">%s</span><span class="s">'</span><br><span class="lineno"> 9</span>            <span class="k">print</span> tempStr <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span><br><span class="lineno">10</span>            <span class="k">return</span> <span class="n">target</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><br><span class="lineno">11</span><br><span class="lineno">12</span>        <span class="k">return</span> <span class="n">wrapper</span><br><span class="lineno">13</span><br><span class="lineno">14</span>    <span class="k">return</span> <span class="n">decorator</span><br><span class="lineno">15</span><br><span class="lineno">16</span><span class="nd">@options</span><span class="p">(</span><span class="mf">5</span><span class="p">)</span><br><span class="lineno">17</span><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">debug_level</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span><br><span class="lineno">18</span>    <span class="k">if</span> <span class="n">debug_level</span><span class="p">:</span> <span class="k">print</span> <span class="s">'[Debug Level </span><span class="si">%s</span><span class="s">] I am the target function'</span> <span class="o">%</span> <span class="n">debug_level</span><br><span class="lineno">19</span>    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><br><span class="lineno">20</span><br><span class="lineno">21</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span><br><span class="lineno">22</span><span class="n">Calling</span> <span class="n">function</span> <span class="s">"target"</span> <span class="k">with</span> <span class="n">arguments</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span> <span class="ow">and</span> <span class="n">keyword</span> <span class="n">arguments</span> <span class="p">{</span><span class="s">'debug_level'</span><span class="p">:</span> <span class="mf">5</span><span class="p">}</span><br><span class="lineno">23</span><span class="p">[</span><span class="n">Debug</span> <span class="n">Level</span> <span class="mf">5</span><span class="p">]</span> <span class="n">I</span> <span class="n">am</span> <span class="n">the</span> <span class="n">target</span> <span class="n">function</span><br><span class="lineno">24</span><span class="mf">3</span><br></pre></div></div></div></div>
<div class="section" id="caveat-function-signatures">
<h2><a class="toc-backref" href="#id12">4&nbsp;&nbsp;&nbsp;약점: 함수 시그너처</a></h2>
<p>
휴. 이제 장식자로 무엇을 할 수 있는지 낱낱이 이해되는가? 좋다 :). 그렇지만, 꼭 언급해야 할 한 가지 약점이 있다.</p>
<p>
<em>장식자 함수</em>가 돌려준 함수는 -- 보통 <em>포장 함수</em> -- <em>목표 함수</em>를 완전히 교체한다. 
나중에 <em>목표 함수</em>라고 생각되는 것을 들여다 보면 실제로는 <em>포장 함수</em>를 들여다 보는 것이다.</p>
<p>
<strong>대부분의 시간 동안은 문제가 없다</strong>. 일반적으로 몇 가지 옵션을 가지고 그냥 호출하면 된다. 프로그램은 그 함수의 <tt class="docutils literal"><span class="pre">__name__</span></tt>이 무엇인지 어떤 인자를 받는지 점검하지 않는다.

그래서 보통 이 문제는 문제가 아니다.</p>
<p>
그렇지만 종종 호출할 함수가 특정 옵션을 지원하는지, 임의의 옵션 또는 그의 <tt class="docutils literal"><span class="pre">__name__</span></tt>이라는 것을 지원하는지 신경써야 할 경우가 있다. 또는 함수의 속성에 관심이 있을 수도 있다. 장식된 함수를 살펴보면, 실제로는 <em>포장 함수</em>를 보고 있는 셈이다.</p>
<p>
아래의 예제에서 <a class="reference external" href="http://docs.python.org/lib/inspect-classes-functions.html">inspect</a> 모듈의 <tt class="docutils literal"><span class="pre">getargspec</span></tt> 함수가 함수의 이름과 인자의 기본값을 얻는 것에 주목하자.</p>
<div class="code" id="11"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno"> 1</span><span class="c"># 이 함수는 이름만 빼고 'target' 함수와 똑 같다.</span><br><span class="lineno"> 2</span><span class="k">def</span> <span class="nf">standalone_function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span><br><span class="lineno"> 3</span>    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><br><span class="lineno"> 4</span><br><span class="lineno"> 5</span><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">target</span><span class="p">):</span><br><span class="lineno"> 6</span><br><span class="lineno"> 7</span>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span><br><span class="lineno"> 8</span>        <span class="k">return</span> <span class="n">target</span><span class="p">()</span><br><span class="lineno"> 9</span><br><span class="lineno">10</span>    <span class="k">return</span> <span class="n">wrapper</span><br><span class="lineno">11</span><br><span class="lineno">12</span><span class="nd">@decorator</span><br><span class="lineno">13</span><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span><br><span class="lineno">14</span>    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><br><span class="lineno">15</span><br><span class="lineno">16</span><span class="o">&gt;&gt;&gt;</span> <span class="k">from</span> <span class="nn">inspect</span> <span class="k">import</span> <span class="n">getargspec</span><br><span class="lineno">17</span><br><span class="lineno">18</span><span class="o">&gt;&gt;&gt;</span> <span class="n">standalone_function</span><span class="o">.</span><span class="n">__name__</span><br><span class="lineno">19</span><span class="s">'standalone_function'</span><br><span class="lineno">20</span><br><span class="lineno">21</span><span class="o">&gt;&gt;&gt;</span> <span class="n">getargspec</span><span class="p">(</span><span class="n">standalone_function</span><span class="p">)</span><br><span class="lineno">22</span><span class="p">([</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">],</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span><br><span class="lineno">23</span><br><span class="lineno">24</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="o">.</span><span class="n">__name__</span><br><span class="lineno">25</span><span class="s">'wrapper'</span><br><span class="lineno">26</span><br><span class="lineno">27</span><span class="o">&gt;&gt;&gt;</span> <span class="n">getargspec</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><br><span class="lineno">28</span><span class="p">([],</span> <span class="s">'args'</span><span class="p">,</span> <span class="s">'kwargs'</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span><br></pre></div></div>
<p>
보시다시피, <em>포장 함수</em>는 원래 <em>목표 함수</em>와 다른 인자를 받았다고 보고한다. 그의 <em>호출 시그너쳐</em>가 바뀌었다.</p>
<div class="section" id="a-solution">
<h3><a class="toc-backref" href="#id13">4.1&nbsp;&nbsp;&nbsp;해결책</a></h3>
<p>
이는 쉽게 해결할 수 있는 문제가 아니다. <a class="reference external" href="http://docs.python.org/lib/module-functools.html">functools 모듈</a>의 <tt class="docutils literal"><span class="pre">update_wrapper</span></tt> 메쏘드가 부분적인 해결책을 제공하는데, 이 메쏘드는 <tt class="docutils literal"><span class="pre">__name__</span></tt>과 기타 속성들을 한 함수에서 또다른 함수로 복사한다. 그러나 가장 큰 문제는 해결하지 못한다: 바뀐 <em>호출 시그너쳐</em>는 어떻게 할 것인가.</p>
<p>
<a class="reference external" href="http://www.phyast.pitt.edu/~micheles/python/documentation.html">decorator 모듈</a>의 <tt class="docutils literal"><span class="pre">decorator</span></tt> 함수가 가장 좋은 해결책을 제공한다: 이 함수는 <em>포장 함수</em>를 동적으로-평가되는 함수 안에 올바른 인자를 가지고 싸 넣을 수 있어서, 원래의 <em>호출 시그너쳐</em>를 복구해 준다. <tt class="docutils literal"><span class="pre">update_wrapper</span></tt> 함수와 비슷하게, <em>목표 함수</em>의 <tt class="docutils literal"><span class="pre">__name__</span></tt>과 기타 속성을 가지고 <em>포장 함수</em>를 갱신할 수도 있다.</p>
<div class="note">
<p class="first admonition-title">주의</p>
<p class="last">앞으로 이 섹션에서  <tt class="docutils literal"><span class="pre">decorator</span></tt> 함수를 언급하면, 이 모듈에서 가져온 것을 의미한다. <em>목표 함수</em>를 변형하는데 사용해 온 <em>장식자 함수</em>가 아님에 주의하자.</p></div>
<div class="admonition-another-way-to-create-decorators admonition">
<p class="first admonition-title">장식자를 만드는 또다른 방법</p>
<p>
그렇지만 불행하게도 <tt class="docutils literal"><span class="pre">decorator</span></tt> 함수는 이를 염두에 두고 작성되지 않았다. 대신 나홀로 <em>포장 함수</em>를 완전히-성장한 장식자로 바꾸도록 작성되었다. 위의 <a class="reference internal" href="#run-time-transformations">실행-시간 변형</a>에서 기술한 함수 내포에 관하여 걱정할 필요없이 말이다.</p>
<p>
이 테크닉이 종종 유용하기는 하지만, 그 만큼 맞춤 재단하기가 힘들다. 
함수가 실행될 때마다 <strong>무엇이든 실행시간에 처리된다</strong>.

<em>목표 함수</em>나 <em>포장 함수</em> 속성을 장식자에 할당하거나 또는 <a class="reference internal" href="#passing-options-to-the-decorator">옵션을 장식자에 건넬 경우</a>를 포함하여 <em>목표 함수</em>가 정의될 때는 <strong>아무 것도 할 수 없다</strong>.</p>
<p>
또한, 생각건대 약간의 블랙 박스 같은 느낌이 든다; 약간 난잡하더라도 장식자가 무슨 일을 하는지 알면 좋겠다.</p>

<p class="last">그러나 이 문제를 해결할 수 있다.</p></div>
<p>
이상적으로 그냥 <tt class="docutils literal"><span class="pre">decorator(wrapper)</span></tt>를 호출하고 그냥 처리되도록 놔두면 된다. 그렇지만, 무슨 일이든 생각만큼 그렇게 간단한 것은 없다. 위에서 기술한 바와 같이, <tt class="docutils literal"><span class="pre">decorator</span></tt> 함수는 건네어진 함수를 -- <em>포장 함수</em>를 -- 동적인 함수 안에 싸 넣어서 시그너처를 고친다. 그러나 여전히 몇 가지 문제가 있다:</p>
<blockquote>
  <dl class="docutils">
    <dt>문제 #1: 
    </dt><dd>그 동적인 함수는 <em>포장 함수</em>를 <tt class="docutils literal"><span class="pre">(func,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></tt>로 호출한다. 
    </dd><dt>해결책 #1: 
    </dt><dd><em>포장 함수</em>가 <tt class="docutils literal"><span class="pre">(func,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></tt>를 받도록 만든다. 그냥 <tt class="docutils literal"><span class="pre">(*args,</span> <span class="pre">**kwargs)</span></tt>를 받는 대신에 말이다. 
    </dd><dt>문제 #2: 
    </dt><dd>그 동적인 함수는 다음으로 실제 장식자로 사용될 또다른 함수 안에 포장된다 -- <em>목표 함수</em>를 가지고 호출되어, 그 포장자 함수를 돌려줄 것이다. 
    </dd><dt>해결책 #2: 
    </dt><dd>
    <em>목표 함수</em>를 가지고 <tt class="docutils literal"><span class="pre">decorator</span></tt>의 반환 값을 호출하여 그 동적인 함수로 다시 돌아간다. 이 함수가 가진 시그너쳐가 올바르기 때문이다. </dd></dl></blockquote>
<p>
이 테크닉은 약간 해킹적이다. 설명하기가 좀 어렵지만 구현하기도 쉽고 잘 작동한다.</p>
<p>
다음은 앞과 같은 예제이지만, 이제는 <tt class="docutils literal"><span class="pre">decorator</span></tt> 함수로 구현하였다 (그리고 이름이 바뀌어서 그렇게 혼란스럽지 않다):</p>
<div class="code" id="12"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno"> 1</span><span class="k">from</span> <span class="nn">decorator</span> <span class="k">import</span> <span class="n">decorator</span><br><span class="lineno"> 2</span><br><span class="lineno"> 3</span><span class="k">def</span> <span class="nf">my_decorator</span><span class="p">(</span><span class="n">target</span><span class="p">):</span><br><span class="lineno"> 4</span><br><span class="lineno"> 5</span>    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="c"># target 함수 뒤에 인자 리스트가 온다.</span><br><span class="lineno"> 6</span>        <span class="k">return</span> <span class="n">target</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><br><span class="lineno"> 7</span><br><span class="lineno"> 8</span>    <span class="c"># target 함수로 반환값을 호출하여 '적절한' 포장자 함수를 돌려받는다.</span><br><span class="lineno"> 9</span>    <span class="k">return</span> <span class="n">decorator</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)(</span><span class="n">target</span><span class="p">)</span><br><span class="lineno">10</span><br><span class="lineno">11</span><br><span class="lineno">12</span><span class="nd">@my_decorator</span><br><span class="lineno">13</span><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span><br><span class="lineno">14</span>    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><br><span class="lineno">15</span><br><span class="lineno">16</span><span class="o">&gt;&gt;&gt;</span> <span class="k">from</span> <span class="nn">inspect</span> <span class="k">import</span> <span class="n">getargspec</span><br><span class="lineno">17</span><br><span class="lineno">18</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="o">.</span><span class="n">__name__</span><br><span class="lineno">19</span><span class="s">'target'</span><br><span class="lineno">20</span><br><span class="lineno">21</span><span class="o">&gt;&gt;&gt;</span> <span class="n">getargspec</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><br><span class="lineno">22</span><span class="p">([</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">],</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span><br></pre></div></div></div></div>
<div class="section" id="putting-it-all-together">
<h2><a class="toc-backref" href="#id14">5&nbsp;&nbsp;&nbsp;모두 하나로 합치기</a></h2>
<p>
종종, 진짜로 <a class="reference external" href="#the-basics">해석-시간</a>과 <a class="reference external" href="#run-time-transformations">실행-시간</a>에 모두 작동하는, 그리고 원래 <em>목표 함수</em>의 <a class="reference external" href="#caveat-function-signatures">시그너쳐</a>를 가진 <a class="reference external" href="#dynamic-decorators">맞춤재단 가능한 장식자</a>가 필요한 경우가 있다.</p>
<p>
다음은 모든 것을 하나로 묶는 예제이다. 앞의 예제를 확대하면, 다시 말해 실행되기 전에 긍정 확인을 요구하는 특정 함수 호출이 필요하면, 그리고 <em>목표 함수</em>마다 그 긍정 문자열을 맞춤재단하기를 바란다면. 

게다가, 어떤 이유로 <a class="footnote-reference" id="id1" href="#id2">[1]</a>, <em>목표 함수</em>에 일치하는 그 장식된 함수의 시그너쳐가 필요하다.</p>
<p>자 시작해 보자:</p>
<div class="code" id="13"><a class="toggle_linenos" href="#"># 's </a>
<div class="highlight"><pre><span class="lineno"> 1</span><span class="k">from</span> <span class="nn">decorator</span> <span class="k">import</span> <span class="n">decorator</span><br><span class="lineno"> 2</span><br><span class="lineno"> 3</span><span class="c"># '옵션' 함수.  옵션을 받아 장식자를 돌려준다.</span><br><span class="lineno"> 4</span><span class="k">def</span> <span class="nf">confirm</span><span class="p">(</span><span class="n">text</span><span class="p">):</span><br><span class="lineno"> 5</span>    <span class="sd">'''</span><br><span class="lineno"> 6</span><span class="sd">    전송될 문자열을 확인 메시지로 건넨다.  장식자를 돌려준다.</span><br><span class="lineno"> 7</span><span class="sd">    '''</span><br><span class="lineno"> 8</span><br><span class="lineno"> 9</span>    <span class="c"># 실제 장식자.  목표 함수를 받는다.</span><br><span class="lineno">10</span>    <span class="k">def</span> <span class="nf">my_decorator</span><span class="p">(</span><span class="n">target</span><span class="p">):</span><br><span class="lineno">11</span>        <span class="c"># 목표 함수가 최초에 해석될 때는 포장 함수 안에서 아무일도 일어나지 않는다.</span><br><span class="lineno">12</span><br><span class="lineno">13</span>        <span class="c"># 장식 함수가 속성을 포장 함수에 복사하기 때문에 문제가 없다.</span><br><span class="lineno">14</span>        <span class="n">target</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="mf">1</span><br><span class="lineno">15</span><br><span class="lineno">16</span>        <span class="c"># 포장 함수. 목표 함수를 교체하고 그의 인자들을 받는다.</span><br><span class="lineno">17</span>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span><br><span class="lineno">18</span>            <span class="c"># 여기에서 args나 kwargs를 가지고 일을 할 수 있다.</span><br><span class="lineno">19</span><br><span class="lineno">20</span>            <span class="n">choice</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><br><span class="lineno">21</span><br><span class="lineno">22</span>            <span class="k">if</span> <span class="n">choice</span> <span class="ow">and</span> <span class="n">choice</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">'y'</span><span class="p">:</span><br><span class="lineno">23</span>                <span class="c"># 입력이 'y'로 시작하면, 그 함수를 인자들을 가지고 호출한다</span><br><span class="lineno">24</span>                <span class="n">result</span> <span class="o">=</span> <span class="n">target</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><br><span class="lineno">25</span>                <span class="c"># 여기에서 그 결과를 가지고 일을 할 수 있다</span><br><span class="lineno">26</span>                <span class="k">return</span> <span class="n">result</span><br><span class="lineno">27</span><br><span class="lineno">28</span>            <span class="k">else</span><span class="p">:</span><br><span class="lineno">29</span>                <span class="k">print</span> <span class="s">'Call to </span><span class="si">%s</span><span class="s"> cancelled'</span> <span class="o">%</span> <span class="n">target</span><span class="o">.</span><span class="n">__name__</span><br><span class="lineno">30</span><br><span class="lineno">31</span>        <span class="c"># 포장자의 호출 시그너쳐를 고친다.</span><br><span class="lineno">32</span>        <span class="k">return</span> <span class="n">decorator</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)(</span><span class="n">target</span><span class="p">)</span><br><span class="lineno">33</span><br><span class="lineno">34</span>    <span class="k">return</span> <span class="n">my_decorator</span><br><span class="lineno">35</span><br><span class="lineno">36</span><span class="nd">@confirm</span><span class="p">(</span><span class="s">'Are you sure you want to add these numbers? '</span><span class="p">)</span><br><span class="lineno">37</span><span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span><br><span class="lineno">38</span>    <span class="k">return</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><br><span class="lineno">39</span><br><span class="lineno">40</span><span class="o">&gt;&gt;&gt;</span> <span class="n">Are</span> <span class="n">you</span> <span class="n">sure</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">add</span> <span class="n">these</span> <span class="n">numbers</span><span class="err">?</span> <span class="n">yes</span><br><span class="lineno">41</span><span class="mf">3</span><br><span class="lineno">42</span><br><span class="lineno">43</span><span class="o">&gt;&gt;&gt;</span> <span class="n">target</span><span class="o">.</span><span class="n">attribute</span><br><span class="lineno">44</span><span class="mf">1</span><br></pre></div></div>

<p>성공이다. 실제로 작동한다.</p></div>
<div class="section" id="conclusion">

<h2><a class="toc-backref" href="#id15">6&nbsp;&nbsp;&nbsp;맺는 말</a></h2>
<p>
언제나와 같이, 여기에서 언급한 것보다 더 좋은 방법이 있다면, 또는 혹 빼먹은 것이 있다면 자유롭게 이 글을 편집해서 그 문제를 고치셔도 좋다.</p></div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id16">7&nbsp;&nbsp;&nbsp;References</a></h2>
<p><a class="reference external" href="http://www.phyast.pitt.edu/~micheles/python/documentation.html">Michele 
Simionato's 'decorator' Module</a></p>
<p><a class="reference external" href="http://www.siafoo.net/article/52#decorators">Python Tips, Tricks, and 
Hacks - Decorators</a></p>
<table class="docutils footnote" id="id2" rules="none" frame="void">
  <colgroup>
  <col class="label">
  <col></colgroup>
  <tbody valign="top">
  <tr>
    <td class="label"><a class="fn-backref" href="#id1">[1]</a></td>
    <td>예를 들어, <a class="reference external" href="http://www.pylonshq.com/">Pylons</a>은 메쏘드 시그너쳐를 점검하여 어떤 인자를 건넬지 결정한다.</td></tr></tbody></table></div></div></div><!-- google_ad_section_end -->

</div></div></div></div></body></html>